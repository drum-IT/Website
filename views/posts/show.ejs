<% include ../partials/header %>
<section class="showcase showcase--content">
	<div class="list">
		<div class="list__controls">
			<a class="list__control" href="/forums/<%= post.forum.id %>">
				<i class="fas fa-chevron-left"></i>
				<span><%= post.forum.title %></span>
			</a>
			<% if (!user) { %>
			<a class="list__control" href="/login">Log In to Reply</a>
			<% } else { %>
			<a class="list__control" href="/replies/new/<%= post.id %>">New Reply</a>
			<% } %>
			<% include ../partials/paginator %>
		</div>
		<div class="list__section">
			<div class="list__section__header list__section__header--nostat">
				<h2>
					<%= post.title %>
				</h2>
				<p><%= post.content %></p>
				<p class="list__feature">
					Posted <%= moment(post.createdAt).fromNow() %>
					by <%= post.author.username %> - <%= replies %> replies
				</p>
			</div>
			<% post.replies.forEach((reply, i) => { %>
				<% if (i === post.replies.length - 1 && i === 0) { %>
				<div class="list__item list__item--nostat list__item--single">
				<% } else if (i === 0) { %>
				<div class="list__item list__item--nostat list__item--top">
				<% } else if (i === post.replies.length - 1) { %>
				<div class="list__item list__item--nostat list__item--bottom">
				<% } else { %>
				<div class="list__item list__item--nostat">
				<% } %>
					<h3 class="list__item__feature">
						<%= moment(reply.createdAt).fromNow() %>, <%= post.author.username %> replied...
					</h3>
					<p class="list__item__content">
						<%= reply.content %>
					</p>
				</div>
			<% }); %>
		</div>
		<% if (post.replies.length > 0) { %>
		<div class="list__controls list__controls--bottom">
			<a class="list__control" href="/forums/<%= post.forum.id %>">
				<i class="fas fa-chevron-left"></i>
				<span>
					<%= post.forum.title %>
				</span>
			</a>
			<% if (!user) { %>
			<a class="list__control" href="/login">Log In to Reply</a>
			<% } else { %>
			<a class="list__control" href="/replies/new/<%= post.id %>">New Reply</a>
			<% } %>
			<% include ../partials/paginator %>
		</div>
		<% } %>
	</div>
</section>
<% include ../partials/footer %>